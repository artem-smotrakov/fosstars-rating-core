name: "Create a report for a project"
description: "The action calculates a security rating for a project and stores it to a branch."
inputs:
  project_scm_url:
    description: "An URL to the project's SCM"
    required: true
    default: "$GITHUB_SERVER_URL/$GITHUB_REPOSITORY"
  report_branch:
    description: "A branch where the report is stored"
    required: true
runs:
  using: "composite"
  steps: 
    - uses: actions/checkout@v1
      with:
        ref: ${{ github.head_ref }}
    - name: "Switch to the Fosstars branch"
      run: |
        git fetch origin $INPUT_REPORT_BRANCH || git branch $INPUT_REPORT_BRANCH
        git chechout $INPUT_REPORT_BRANCH
    - name: "Generate a report"
      run: date +%s > report.txt # just for testing
    - name: "Commit the report"
      run: |
        git config --global user.name "Fosstars"
        git config --global user.email "fosstars@users.noreply.github.com"
        git remote set-url origin https://x-access-token:${{ secrets.GITHUB_TOKEN }}@github.com/${{ github.repository }}
        git commit -am "Update Fosstars report"
        git push origin $INPUT_REPORT_BRANCH
